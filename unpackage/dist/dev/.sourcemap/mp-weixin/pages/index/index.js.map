{"version":3,"sources":["uni-app:///main.js","webpack:///D:/大三上课程资料/cloud/12/cloud-disk/pages/index/index.vue?28f8","webpack:///D:/大三上课程资料/cloud/12/cloud-disk/pages/index/index.vue?7838","webpack:///D:/大三上课程资料/cloud/12/cloud-disk/pages/index/index.vue?8171","webpack:///D:/大三上课程资料/cloud/12/cloud-disk/pages/index/index.vue?45c0","uni-app:///pages/index/index.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,4F;AACAA,UAAU,CAACC,cAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;;;AAGpD;AAC+L;AAC/L,gBAAgB,mMAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA8uB,CAAgB,6tBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACwKlwB;AACA;AACA,kBADA;AAEA,gBAFA;AAGA,oBAHA;AAIA,sBAJA,EADA;;AAOA,MAPA,kBAOA;AACA;AACA,cADA;AAEA,kBAFA;AAGA;AACA;AACA,qBADA;AAEA,mBAFA,EADA;;AAKA;AACA,qBADA;AAEA,2BAFA,EALA,CAHA;;;AAaA,qBAbA;AAcA,oBAdA;;AAgBA,cAhBA;AAiBA;AACA;AACA,6BADA;AAEA,6BAFA;AAGA,oBAHA,EADA;;AAMA;AACA,6BADA;AAEA,6BAFA;AAGA,oBAHA,EANA;;AAWA;AACA,6BADA;AAEA,2BAFA;AAGA,oBAHA,EAXA;;AAgBA;AACA,6BADA;AAEA,6BAFA;AAGA,qBAHA,EAhBA,CAjBA;;;AAuCA;AACA,sBADA;AAEA,oBAFA,EAvCA;;;AA4CA,GApDA;AAqDA,QArDA,oBAqDA;AACA;AACA;AACA;AACA;AACA;AACA,GA3DA;AA4DA;AACA,WADA,qBACA;AACA;AACA;AACA;AACA;AACA;AACA,KAPA;AAQA,WARA,qBAQA;AACA;AACA;AACA;AACA;AACA;AACA,KAdA;AAeA;AACA,aAhBA,uBAgBA;AACA;AACA,KAlBA;AAmBA;AACA,cApBA,wBAoBA;AACA;AACA,KAtBA;AAuBA;AACA,WAxBA,qBAwBA;AACA;AACA;AACA;AACA,6BADA;AAEA,oBAFA,EADA;;AAKA;AACA,8BADA;AAEA,oBAFA,EALA;;;AAUA;AACA;AACA;AACA,2BADA;AAEA,kBAFA,EADA;;AAKA;AACA,+BADA;AAEA,kBAFA,EALA;;AASA;AACA,4BADA;AAEA,kBAFA,EATA;;AAaA;AACA,kCADA;AAEA,mBAFA,EAbA;;;AAkBA,KAvDA,EA5DA;;AAqHA;AACA,cADA,sBACA,IADA,EACA;AACA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AACA,oBADA;AAEA,wBAFA;AAGA,YAHA;;AAKA,OAZA;AAaA,KAfA;AAgBA,WAhBA,qBAgBA;AACA;AACA;AACA;AACA;AACA,SADA,yBACA,YADA,sBACA,OADA,GACA;AACA,mBADA,EADA;;AAIA,UAJA,CAIA;AACA;AACA,OANA;AAOA,KA3BA;AA4BA;AACA,cA7BA,sBA6BA,KA7BA,EA6BA;AACA;AACA;AACA;AACA,KAjCA;AAkCA;AACA,WAnCA,mBAmCA,IAnCA,EAmCA;AACA;AACA;AACA;AACA;AACA,WAFA;AAGA;AACA,6BADA;AAEA,gEAFA;;AAIA;AACA;AACA;AACA,yEADA;;AAGA;AACA;AACA;AACA,uBADA;AAEA,2BAFA;;AAIA;AACA;AACA,uBADA;AAEA,2CAFA;;AAIA,gBAzBA;;AA2BA,KA/DA;AAgEA,UAhEA,kBAgEA,CAhEA,EAgEA;AACA;AACA;AACA,KAnEA;AAoEA;AACA,kBArEA,0BAqEA,OArEA,EAqEA;AACA;AACA;AACA,OAFA;AAGA,KAzEA;AA0EA;AACA,qBA3EA,6BA2EA,IA3EA,EA2EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BADA;AAEA,0BAFA;;AAIA,WARA;AASA;AACA;AACA;AA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","file":"pages/index/index.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/index/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=57280228&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"57280228\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/index/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=57280228&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../ProgramFiles/HBuilder/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<!-- 自定义导航栏 -->\r\n\t\t<nav-bar>\r\n\t\t\t<template v-if=\"checkCount === 0\">\r\n\t\t\t\t<!-- 插槽再一次发挥逆天作用，进入子目录，左边将变成返回箭头，导航栏变成子目录名称 -->\r\n\t\t\t\t<template slot=\"left\">\r\n\t\t\t\t\t<view\r\n\t\t\t\t\t\tstyle=\"width: 60rpx;height: 60rpx;\"\r\n\t\t\t\t\t\tclass=\"flex align-center justify-center bg-light rounded-circle ml-3\"\r\n\t\t\t\t\t\thover-class=\"bg-hover-light\"\r\n\t\t\t\t\t\t@tap=\"backUp\"\r\n\t\t\t\t\t\tv-if=\"current\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<text class=\"iconfont icon-fanhui\"></text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<text class=\"font-md ml-3\">{{ current ? current.name : '首页' }}</text>\r\n\t\t\t\t</template>\r\n\t\t\t\t<template slot=\"right\">\r\n\t\t\t\t\t<view\r\n\t\t\t\t\t\tstyle=\"width: 60rpx;height: 60rpx;\"\r\n\t\t\t\t\t\tclass=\"flex align-center justify-center bg-light rounded-circle mr-3\"\r\n\t\t\t\t\t\thover-class=\"bg-hover-light\"\r\n\t\t\t\t\t\t@tap=\"openAddDialog\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<text class=\"iconfont icon-zengjia\"></text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view\r\n\t\t\t\t\t\tstyle=\"width: 60rpx;height: 60rpx;\"\r\n\t\t\t\t\t\tclass=\"flex align-center justify-center bg-light rounded-circle mr-3\"\r\n\t\t\t\t\t\thover-class=\"bg-hover-light\"\r\n\t\t\t\t\t\t@click=\"openSortDialog\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<text class=\"iconfont icon-gengduo\"></text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</template>\r\n\t\t\t</template>\r\n\r\n\t\t\t<template v-else>\r\n\t\t\t\t<view slot=\"left\" class=\"font-md ml-3 text-primary\" @click=\"handleCheckAll(false)\">取消</view>\r\n\t\t\t\t<text class=\"font-md font-weight-bold\">已选中{{ checkCount }}个</text>\r\n\t\t\t\t<view slot=\"right\" class=\"font-md mr-3 text-primary\" @click=\"handleCheckAll(true)\">全选</view>\r\n\t\t\t</template>\r\n\t\t</nav-bar>\r\n\r\n\t\t<!-- 搜索框 -->\r\n\t\t<view class=\"px-3 py-2\">\r\n\t\t\t<view class=\"position-relative\">\r\n\t\t\t\t<view\r\n\t\t\t\t\tstyle=\"height: 70rpx;width: 70rpx;position: absolute;top: 0;left: 0;\"\r\n\t\t\t\t\tclass=\"flex align-center justify-center text-light-muted\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<text class=\"iconfont icon-sousuo\"></text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<input\r\n\t\t\t\t\tstyle=\"height: 70rpx;padding-left: 70rpx;\"\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tclass=\"bg-light font-md rounded-circle\"\r\n\t\t\t\t\tplaceholder=\"搜索网盘文件\"\r\n\t\t\t\t\t@input=\"search\"\r\n\t\t\t\t/>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 列表 -->\r\n\t\t<f-list\r\n\t\t\tv-for=\"(item, index) in list\"\r\n\t\t\t:key=\"index\"\r\n\t\t\t:item=\"item\"\r\n\t\t\t@click=\"doEvent(item)\"\r\n\t\t\t:index=\"index\"\r\n\t\t\t@select=\"select\"\r\n\t\t></f-list>\r\n\r\n\t\t<!-- 底部操作条 -->\r\n\t\t<!-- 选中个数大于0才会出现这个操作条 -->\r\n\t\t<view v-if=\"checkCount > 0\">\r\n\t\t\t<!-- 这里要留一定的高度，因为底部操作条需要被固定在底部，并空出底部tabbar高度的地方 -->\r\n\t\t\t<view style=\"height: 115rpx;\"></view>\r\n\t\t\t<!-- 操作条容器的样式，高度，颜色，固定在底部，垂直方向拉升效果 -->\r\n\t\t\t<view style=\"height: 115rpx;\" class=\"flex align-stretch bg-primary text-white fixed-bottom\">\r\n\t\t\t\t<!-- 根据元素个数等分容器，所以要么四个等分，要么两个等分，行高的修改可以让图标和文字之间的距离变得合理，点击还会变色:hover-class -->\r\n\t\t\t\t<view\r\n\t\t\t\t\tclass=\"flex-1 flex flex-column align-center justify-center\"\r\n\t\t\t\t\tstyle=\"line-height: 1.5;\"\r\n\t\t\t\t\tv-for=\"(item, index) in actions\"\r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\thover-class=\"bg-hover-primary\"\r\n\t\t\t\t\t@click=\"handleBottomEvent(item)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<text class=\"iconfont\" :class=\"item.icon\"></text>\r\n\t\t\t\t\t{{ item.name }}\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 是否要删除，通过ref指定为delete对话框 -->\r\n\t\t<f-dialog ref=\"delete\">是否删除选中？</f-dialog>\r\n\r\n\t\t<!-- 重命名,通过ref定义不同的对话框对象，不同操作弹出的dialog是不同的对象 -->\r\n\t\t<f-dialog ref=\"rename\">\r\n\t\t\t<input\r\n\t\t\t\ttype=\"text\"\r\n\t\t\t\tv-model=\"renameValue\"\r\n\t\t\t\tclass=\"flex-1 bg-light rounded px-2\"\r\n\t\t\t\tstyle=\"height: 95rpx;\"\r\n\t\t\t\tplaceholder=\"重命名\"\r\n\t\t\t/>\r\n\t\t</f-dialog>\r\n\r\n\t\t<!-- 新建文件夹，使用自定义弹出层，使用input作为插槽，绑定data中的newdirname变量 -->\r\n\t\t<f-dialog ref=\"newdir\">\r\n\t\t\t<input\r\n\t\t\t\ttype=\"text\"\r\n\t\t\t\tv-model=\"newdirname\"\r\n\t\t\t\tclass=\"flex-1 bg-light rounded px-2\"\r\n\t\t\t\tstyle=\"height: 95rpx;\"\r\n\t\t\t\tplaceholder=\"新建文件夹名称\"\r\n\t\t\t/>\r\n\t\t</f-dialog>\r\n\r\n\t\t<!-- 添加操作条，应当能理解这里ref的作用了，type表示弹出的的位置类型，具体取值都在popup子组件中 -->\r\n\t\t<uni-popup ref=\"add\" type=\"bottom\">\r\n\t\t\t<view class=\"bg-white flex\" style=\"height: 200rpx;\">\r\n\t\t\t\t<!-- 遍历addList数组，纵向flex，为每个操作分配等高的空间，每个操作有图标和名称组成 -->\r\n\t\t\t\t<view\r\n\t\t\t\t\tclass=\"flex-1 flex align-center justify-center flex-column\"\r\n\t\t\t\t\thover-class=\"bg-light\"\r\n\t\t\t\t\tv-for=\"(item, index) in addList\"\r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t@tap=\"handleAddEvent(item)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<!-- 每个操作的图标，可以传入图标的名称和颜色，很灵活 -->\r\n\t\t\t\t\t<text\r\n\t\t\t\t\t\tstyle=\"width: 110rpx;height: 110rpx;\"\r\n\t\t\t\t\t\tclass=\"rounded-circle bg-light iconfont flex align-center justify-center\"\r\n\t\t\t\t\t\t:class=\"item.icon + ' ' + item.color\"\r\n\t\t\t\t\t></text>\r\n\t\t\t\t\t<!-- 每个操作的名称 -->\r\n\t\t\t\t\t<text class=\"font text-muted\">{{ item.name }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\r\n\t\t<!-- 排序框,底部弹出，遍历排序操作数组，为当前索引项绑定文字蓝色样式 -->\r\n\t\t<uni-popup ref=\"sort\" type=\"bottom\">\r\n\t\t\t<view class=\"bg-white\">\r\n\t\t\t\t<view\r\n\t\t\t\t\tv-for=\"(item, index) in sortOptions\"\r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\tclass=\"flex align-center justify-center py-3 font border-bottom border-light-secondary\"\r\n\t\t\t\t\t:class=\"index === sortIndex ? 'text-main' : 'text-dark'\"\r\n\t\t\t\t\thover-class=\"bg-light\"\r\n\t\t\t\t\t@click=\"changeSort(index)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{{ item.name }}\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport navBar from '@/components/common/nav-bar.vue';\r\nimport fList from '@/components/common/f-list.vue';\r\nimport fDialog from '@/components/common/f-dialog.vue';\r\nimport uniPopup from '@/components/uni-ui/uni-popup/uni-popup.vue';\r\n\r\nexport default {\r\n\tcomponents: {\r\n\t\tnavBar,\r\n\t\tfList,\r\n\t\tfDialog,\r\n\t\tuniPopup\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tdirs: [],\r\n\t\t\tsortIndex: 0,\r\n\t\t\tsortOptions: [\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '按名称排序',\r\n\t\t\t\t\tkey: 'name'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '按时间排序',\r\n\t\t\t\t\tkey: 'created_time'\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\trenameValue: '',\r\n\t\t\tnewdirname: '',\r\n\r\n\t\t\tlist: [],\r\n\t\t\taddList: [\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: 'icon-file-b-6',\r\n\t\t\t\t\tcolor: 'text-success',\r\n\t\t\t\t\tname: '上传图片'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: 'icon-file-b-9',\r\n\t\t\t\t\tcolor: 'text-primary',\r\n\t\t\t\t\tname: '上传视频'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: 'icon-file-b-8',\r\n\t\t\t\t\tcolor: 'text-muted',\r\n\t\t\t\t\tname: '上传文件'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: 'icon-file-b-2',\r\n\t\t\t\t\tcolor: 'text-warning',\r\n\t\t\t\t\tname: '新建文件夹'\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\tstate: {\r\n\t\t\t\tuploadList: [],\r\n\t\t\t\tdownlist: []\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\tonLoad() {\r\n\t\tlet dirs = uni.getStorageSync('dirs');\r\n\t\tif (dirs) {\r\n\t\t\tthis.dirs = JSON.parse(dirs);\r\n\t\t}\r\n\t\tthis.getData();\r\n\t},\r\n\tcomputed: {\r\n\t\tfile_id() {\r\n\t\t\tlet l = this.dirs.length;\r\n\t\t\tif (l === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn this.dirs[l - 1].id;\r\n\t\t},\r\n\t\tcurrent() {\r\n\t\t\tlet l = this.dirs.length;\r\n\t\t\tif (l === 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn this.dirs[l - 1];\r\n\t\t},\r\n\t\t// 选中列表\r\n\t\tcheckList() {\r\n\t\t\treturn this.list.filter(item => item.checked);\r\n\t\t},\r\n\t\t// 选中数量\r\n\t\tcheckCount() {\r\n\t\t\treturn this.checkList.length;\r\n\t\t},\r\n\t\t// 操作菜单\r\n\t\tactions() {\r\n\t\t\tif (this.checkCount > 1) {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ticon: 'icon-xiazai',\r\n\t\t\t\t\t\tname: '下载'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ticon: 'icon-shanchu',\r\n\t\t\t\t\t\tname: '删除'\r\n\t\t\t\t\t}\r\n\t\t\t\t];\r\n\t\t\t}\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: 'icon-xiazai',\r\n\t\t\t\t\tname: '下载'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: 'icon-fenxiang-1',\r\n\t\t\t\t\tname: '分享'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: 'icon-shanchu',\r\n\t\t\t\t\tname: '删除'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ticon: 'icon-chongmingming',\r\n\t\t\t\t\tname: '重命名'\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tformatList(list) {\r\n\t\t\treturn list.map(item => {\r\n\t\t\t\tlet type = 'none';\r\n\t\t\t\tif (item.isdir === 1) {\r\n\t\t\t\t\ttype = 'dir';\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttype = item.ext.split('/')[0] || 'none';\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttype,\r\n\t\t\t\t\tchecked: false,\r\n\t\t\t\t\t...item\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t},\r\n\t\tgetData() {\r\n\t\t\tconsole.log(this.file_id + '>>>>>>>>>>>>');\r\n\t\t\tlet orderby = this.sortOptions[this.sortIndex].key;\r\n\t\t\tconsole.log(orderby + '&&&&&&&&');\r\n\t\t\tthis.$H\r\n\t\t\t\t.get(`/file?file_id=${this.file_id}&orderby=${orderby}`, {\r\n\t\t\t\t\ttoken: true\r\n\t\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tthis.list = this.formatList(res.rows);\r\n\t\t\t\t});\r\n\t\t},\r\n\t\t// 切换排序\r\n\t\tchangeSort(index) {\r\n\t\t\tthis.sortIndex = index;\r\n\t\t\tthis.getData();\r\n\t\t\tthis.$refs.sort.close();\r\n\t\t},\r\n\t\t// 列表点击事件处理\r\n\t\tdoEvent(item) {\r\n\t\t\tswitch (item.type) {\r\n\t\t\t\tcase 'image': // 预览图片\r\n\t\t\t\t\tlet images = this.list.filter(item => {\r\n\t\t\t\t\t\treturn item.type === 'image';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tuni.previewImage({\r\n\t\t\t\t\t\tcurrent: item.url,\r\n\t\t\t\t\t\turls: images.map(item => item.url)\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'video':\r\n\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\turl: '../video/video?url=' + item.url + '&title=' + item.name\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.dirs.push({\r\n\t\t\t\t\t\tid: item.id,\r\n\t\t\t\t\t\tname: item.name\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.getData();\r\n\t\t\t\t\tuni.setStorage({\r\n\t\t\t\t\t\tkey: 'dirs',\r\n\t\t\t\t\t\tdata: JSON.stringify(this.dirs)\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\t\tselect(e) {\r\n\t\t\tconsole.log(e.value);\r\n\t\t\tthis.list[e.index].checked = e.value;\r\n\t\t},\r\n\t\t// 全选/取消全选\r\n\t\thandleCheckAll(checked) {\r\n\t\t\tthis.list.forEach(item => {\r\n\t\t\t\titem.checked = checked;\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 处理底部操作条事件\r\n\t\thandleBottomEvent(item) {\r\n\t\t\tswitch (item.name) {\r\n\t\t\t\tcase '删除':\r\n\t\t\t\t\tthis.$refs.delete.open(close => {\r\n\t\t\t\t\t\t//对list进行过滤，留下未被选中的\r\n\t\t\t\t\t\tthis.list = this.list.filter(item => !item.checked);\r\n\t\t\t\t\t\tclose();\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '删除成功',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase '重命名':\r\n\t\t\t\t\t//重命名只能对单个文件进行，所以取this.checkList[0]，也就是选中的唯一元素\r\n\t\t\t\t\tthis.renameValue = this.checkList[0].name;\r\n\t\t\t\t\tthis.$refs.rename.open(close => {\r\n\t\t\t\t\t\tif (this.renameValue == '') {\r\n\t\t\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '文件名称不能为空',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.$H\r\n\t\t\t\t\t\t\t.post(\r\n\t\t\t\t\t\t\t\t'/file/rename',\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tid: this.checkList[0].id,\r\n\t\t\t\t\t\t\t\t\tfile_id: this.file_id,\r\n\t\t\t\t\t\t\t\t\tname: this.renameValue\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{ token: true }\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\t//更新该元素的name值，实时看到效果\r\n\t\t\t\t\t\t\t\tthis.checkList[0].name = this.renameValue;\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '重命名成功',\r\n\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tclose();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase '下载':\r\n\t\t\t\t\tthis.download();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase '分享':\r\n\t\t\t\t\tthis.share();\r\n\t\t\t\t\tthis.handleCheckAll(false);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 打开添加操作条\r\n\t\topenAddDialog() {\r\n\t\t\tthis.$refs.add.open();\r\n\t\t},\r\n\t\topenSortDialog() {\r\n\t\t\tthis.$refs.sort.open();\r\n\t\t},\r\n\t\t//处理添加操作条的各种事件\r\n\t\thandleAddEvent(item) {\r\n\t\t\tthis.$refs.add.close();\r\n\t\t\tswitch (item.name) {\r\n\t\t\t\tcase '新建文件夹':\r\n\t\t\t\t\tthis.$refs.newdir.open(close => {\r\n\t\t\t\t\t\tif (this.newdirname == '') {\r\n\t\t\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '文件夹名称不能为空',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//请求新增文件夹接口\r\n\t\t\t\t\t\tthis.$H\r\n\t\t\t\t\t\t\t.post(\r\n\t\t\t\t\t\t\t\t'/file/createdir',\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tfile_id: this.file_id,\r\n\t\t\t\t\t\t\t\t\tname: this.newdirname\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{ token: true }\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\tthis.getData();\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '新建文件夹成功',\r\n\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tclose();\r\n\t\t\t\t\t\tthis.newdirname = '';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase '上传图片':\r\n\t\t\t\t\t//选择图片，限制为9张\r\n\t\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\t\tcount: 9,\r\n\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\t//选择图片成功，就异步调用上传接口\r\n\t\t\t\t\t\t\tres.tempFiles.forEach(item => {\r\n\t\t\t\t\t\t\t\tconsole.log(item);\r\n\t\t\t\t\t\t\t\tthis.upload(item, 'image');\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\t\t//搜索功能\r\n\t\tsearch(e) {\r\n\t\t\tif (e.detail.value == '') {\r\n\t\t\t\treturn this.getData();\r\n\t\t\t}\r\n\r\n\t\t\tthis.$H\r\n\t\t\t\t.get('/file/search?keyword=' + e.detail.value, {\r\n\t\t\t\t\ttoken: true\r\n\t\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\tthis.list = this.formatList(res);\r\n\t\t\t\t});\r\n\t\t},\r\n\t\t// 返回上一个目录\r\n\t\tbackUp() {\r\n\t\t\tthis.dirs.pop();\r\n\t\t\tthis.getData();\r\n\t\t\tuni.setStorage({\r\n\t\t\t\tkey: 'dirs',\r\n\t\t\t\tdata: JSON.stringify(this.dirs)\r\n\t\t\t});\r\n\t\t},\r\n\t\t//搜索功能\r\n\t\tsearch(e) {\r\n\t\t\tif (e.detail.value == '') {\r\n\t\t\t\treturn this.getData();\r\n\t\t\t}\r\n\r\n\t\t\tthis.$H\r\n\t\t\t\t.get('/file/search?keyword=' + e.detail.value, {\r\n\t\t\t\t\ttoken: true\r\n\t\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\tthis.list = this.formatList(res);\r\n\t\t\t\t});\r\n\t\t},\r\n\t\t//生成唯一ID\r\n\t\tgetID(length) {\r\n\t\t\treturn Number(\r\n\t\t\t\tMath.random()\r\n\t\t\t\t\t.toString()\r\n\t\t\t\t\t.substr(3, length) + Date.now()\r\n\t\t\t).toString(36);\r\n\t\t},\r\n\t\t//上传\r\n\t\tupload(file, type) {\r\n\t\t\t//上传文件类型\r\n\t\t\tlet t = type;\r\n\t\t\t//上传的key,用来区分每个文件\r\n\t\t\tconst key = this.getID(8);\r\n\t\t\t//构建上传文件的对象，文件名，类型，大小，唯一的key，进度，状态，创建时间\r\n\t\t\tlet obj = {\r\n\t\t\t\tname: file.name,\r\n\t\t\t\ttype: t,\r\n\t\t\t\tsize: file.size,\r\n\t\t\t\tkey,\r\n\t\t\t\tprogress: 0,\r\n\t\t\t\tstatus: true,\r\n\t\t\t\tcreated_time: new Date().getTime()\r\n\t\t\t};\r\n\t\t\t//创建上传任务，分发给Vuex的Actions,异步上传调度，主要是实现上传进度的回调\r\n\t\t\tthis.$store.dispatch('createUploadJob', obj);\r\n\t\t\t//上传，查询参数为当前位置所在目录的id，body参数为文件路径\r\n\t\t\tthis.$H\r\n\t\t\t\t.upload(\r\n\t\t\t\t\t'/upload?file_id=' + this.file_id,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfilePath: file.path\r\n\t\t\t\t\t},\r\n\t\t\t\t\tp => {\r\n\t\t\t\t\t\t//更新上传任务\r\n\t\t\t\t\t\tthis.$store.dispatch('updateUploadJob', {\r\n\t\t\t\t\t\t\tstatus: true,\r\n\t\t\t\t\t\t\tprogress: p,\r\n\t\t\t\t\t\t\tkey\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\t//上传成功，请求数据更新列表\r\n\t\t\t\t\tthis.getData();\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tdownload() {\r\n\t\t\tthis.checkList.forEach(item => {\r\n\t\t\t\tif (item.isdir === 0) {\r\n\t\t\t\t\tconst key = this.getID(8);\r\n\r\n\t\t\t\t\tlet obj = {\r\n\t\t\t\t\t\tname: item.name,\r\n\t\t\t\t\t\ttype: item.type,\r\n\t\t\t\t\t\tsize: item.size,\r\n\t\t\t\t\t\tkey,\r\n\t\t\t\t\t\tprogress: 0,\r\n\t\t\t\t\t\tstatus: true,\r\n\t\t\t\t\t\tcreated_time: new Date().getTime()\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t//创建下载任务\r\n\t\t\t\t\tthis.$store.dispatch('createDownloadJob', obj);\r\n\r\n\t\t\t\t\tlet url = item.url;\r\n\r\n\t\t\t\t\tlet d = uni.downloadFile({\r\n\t\t\t\t\t\turl,\r\n\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\t\t\t\tconsole.log('下载成功', res);\r\n\t\t\t\t\t\t\t\tuni.saveFile({\r\n\t\t\t\t\t\t\t\t\ttempFilePath: item.tempFilePath\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\td.onProgressUpdate(res => {\r\n\t\t\t\t\t\tthis.$store.dispatch('updateDownloadJob', {\r\n\t\t\t\t\t\t\tprogress: res.progress,\r\n\t\t\t\t\t\t\tstatus: true,\r\n\t\t\t\t\t\t\tkey\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '已加入下载任务',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t\tthis.handleCheckAll(false);\r\n\t\t},\r\n\t\tshare() {\r\n\t\t\tthis.$H\r\n\t\t\t\t.post(\r\n\t\t\t\t\t'/share/create',\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfile_id: this.checkList[0].id\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{ token: true }\r\n\t\t\t\t)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: res,\r\n\t\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\t\tsuccess: result => {\r\n\t\t\t\t\t\t\t//不能再用res，会和前面冲突\r\n\t\t\t\t\t\t\t// #ifndef H5\r\n\t\t\t\t\t\t\tuni.setClipboardData({\r\n\t\t\t\t\t\t\t\t//复制到剪贴板\r\n\t\t\t\t\t\t\t\tdata: res,\r\n\t\t\t\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '复制成功',\r\n\t\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped></style>\n"],"sourceRoot":""}